/*!
 * Visual Navigation (visualNav) v2.4.3
 * https://github.com/Mottie/visualNav/wiki
 * by Rob Garrison (Mottie)
 * MIT licensed.
 */
;(function(c){c.visualNav=function(g,h){var b,a=this;a.$el=c(g);a.$el.data("visualNav",a);a.init=function(){a.initialized=!1;a.options=b=c.extend({},c.visualNav.defaultOptions,h);a.winLoc=window.location;a.$win=c(window);a.$doc=c(document);var d="html, body";c("html, body").each(function(){var a=c(this),b=a.scrollTop();a.scrollTop(b+1);if(a.scrollTop()===b+1)return d=this.nodeName.toLowerCase(),a.scrollTop(b),!1});a.$body=c(d);a.$lastItem=[null];c.each(b.easing,function(a,d){c.isFunction(c.easing[d])|| (b.easing[a]="swing")});b.stopOnInteraction&&a.$body.bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(b){(0<b.which||"mousedown"===b.type||"mousewheel"===b.type)&&a.$body.stop()});a.$win.bind("scroll resize",function(){a.throttle()});a.update();b.useHash&&a.winLoc.hash&&a.animate(a.winLoc.hash);a.findLocation();a.$el.find("."+b.selectedClass+(b.selectedAppliedTo===b.link?"":" "+b.link)).trigger("click.visualNav",!0)};a.update=function(){a.$content=c("."+b.contentClass);a.leftMargin= parseInt(a.$content.css("margin-left"),10);a.rightMargin=parseInt(a.$content.css("margin-right"),10);var d,e="."+b.externalLinks;a.$links=c(a.$el.find(b.selectedAppliedTo+(b.selectedAppliedTo===b.link?"":" "+b.link)).map(function(a,b){d=c(b);return d.hasClass(e)||d.closest(e).length?null:b}));e="."+b.contentLinks;a.$links.add(c(e+","+e+" a")).unbind("click.visualNav").bind("click.visualNav",function(d,e){a.animate(c(this).attr(b.targetAttr)||c(this).attr("href"),e);return!1});a.$items=b.selectedAppliedTo=== b.link?a.$links:c(a.$links.map(function(){return c(this).closest(b.selectedAppliedTo)[0]}));a.initialized&&a.findLocation()};a.animate=function(d,e){if("#"!==d&&c(d).length){var f=c(d).eq(0).closest("."+b.contentClass);f.length&&(a.curHash=f[0].id||"",a.$curContent=f,a.initialized&&"function"===typeof b.beforeAnimation&&b.beforeAnimation(a,f),a.$body.stop().animate({scrollLeft:Math.min(f.offset().left,a.$doc.width()-a.$win.width())-a.leftMargin,scrollTop:Math.min(f.offset().top,a.$doc.height()-a.$win.height())}, {queue:!1,duration:a.initialized?b.animationTime:0,easing:b.easing[0],specialEasing:{scrollLeft:b.easing[0]||"swing",scrollTop:b.easing[1]||b.easing[0]||"swing"},complete:function(){a.completed(e)}}))}};a.throttle=function(){a.flag||(a.flag=!0,a.timer=setTimeout(function(){a.flag=!1;a.findLocation()},100))};a.updateHash=function(){var d;if(d=b.selectedAppliedTo===b.link?a.$curItem.attr("href"):a.$curItem.find(b.link).attr("href")){d=d.replace(/^#/,"");var e,f=c("#"+d);f.length&&(f.attr("id",""),e= c("<div></div>").css({position:"absolute",visibility:"hidden",top:c(document).scrollTop()+"px"}).attr("id",d).appendTo(document.body));a.setHash("#"+d);f.length&&(e.remove(),f.attr("id",d))}};a.setHash=function(b){a.winLoc.hash!==b&&(a.winLoc.replace?a.winLoc.replace(b):a.winLoc.hash=b)};a.completed=function(c){b.useHash&&a.setHash("#"+a.curHash);a.initialized?"function"===typeof b.complete&&b.complete(a,a.$curContent):c&&("function"===typeof b.initialized&&b.initialized(a,a.$curContent),a.initialized= !0);a.flag=!1};a.findLocation=function(){var d,e,f,k,g,h,m,p,l=a.$win.width(),q=a.$win.scrollLeft(),r=a.$win.scrollTop(),t=q+l,n=r+a.$win.height(),u=a.$doc.height();a.$items.removeClass(b.inViewClass);b.fitContent&&a.$content.width(l-a.leftMargin-a.rightMargin);a.$links.each(function(l){k=c(this).attr(b.targetAttr);d="#"===k||1>=k.length?"":c(k);d.length&&(f=Math.ceil(d.offset().top),e=Math.ceil(d.offset().left),h=d.outerHeight(),g=f+h+b.bottomMargin,m=d.outerWidth(),p=e+m,f<n&&(f+h-b.bottomMargin> r||g>n)&&e<t&&(e+m-b.bottomMargin>q||p>t)&&a.$items.eq(l).addClass(b.inViewClass))});k=n+b.bottomMargin>=u?":last":":first";a.$items.removeClass(b.selectedClass);a.$curItem=a.$items.filter("."+b.inViewClass+k).addClass(b.selectedClass);a.$curItem[0]!==a.$lastItem[0]&&(a.$lastItem=a.$curItem,a.$content.removeClass(b.currentContent),k="."+b.selectedClass+(b.selectedAppliedTo===b.link?"":" "+b.link),d=a.$el.find(k).attr(b.targetAttr),a.$curContent=c(d).closest("."+b.contentClass).addClass(b.currentContent), a.initialized&&"function"===typeof b.changed&&b.changed(a,a.$curContent));b.useHash&&a.updateHash()};a.init()};c.visualNav.defaultOptions={link:"a",targetAttr:"href",selectedAppliedTo:"li",contentClass:"content",contentLinks:"visualNav",externalLinks:"external",useHash:!0,inViewClass:"inView",selectedClass:"selected",currentContent:"current",bottomMargin:100,fitContent:!1,animationTime:1200,easing:["swing","swing"],stopOnInteraction:!0,initialized:null,beforeAnimation:null,complete:null,changed:null}; c.fn.visualNav=function(g){return this.each(function(){var h=c(this).data("visualNav");(typeof g).match("object|undefined")?h?h.update():new c.visualNav(this,g):"string"===typeof g&&/^(#|\.)/.test(g)&&h.animate(g)})};c.fn.getvisualNav=function(){return this.data("visualNav")}})(jQuery);
