/*
 * visualNavigation (visualNav) v2.0 minified
 * http://wowmotty.blogspot.com/2010/07/visual-navigation.html
 *
 * Copyright (c) 2010 Rob Garrison (aka Mottie & Fudgey)
 * Dual licensed under the MIT and GPL licenses.
 *
 * Plugin base: http://starter.pixelgraphics.us/
 */

(function(b){b.visualNav=function(e,l){var a=this;a.$el=b(e);a.el=e;a.$el.data("visualNav",a);a.init=function(){a.options=b.extend({},b.visualNav.defaultOptions,l);b("html,body").bind("scroll mousedown DOMMouseScroll mousewheel keyup",function(c){if(c.which>0||c.type=="mousedown"||c.type=="mousewheel")b("html,body").stop()});a.$el.find(a.options.link).click(function(){var c,d=b(this).attr(a.options.targetAttr);if(b(d).length){c=Math.min(b(d).offset().top,b(document).height()-b(window).height());b("html,body").stop().animate({scrollTop:c}, a.options.animationTime,function(){window.location.hash=d})}return false});b(window).scroll(function(){a.findLocation()}).resize(function(){a.findLocation()})};a.findLocation=function(){var c,d,f,j,g,k=b(window).scrollTop(),h=k+b(window).height();f=b(document).height();var i=a.$el.find(a.options.selectedAppliedTo).removeClass(a.options.inViewClass);a.$el.find(a.options.link).each(function(m){c=b(b(this).attr(a.options.targetAttr));if(c.length){d=c.offset().top;g=c.nextAll(a.options.contentClass+":first").outerHeight(); j=d+g+a.options.bottomMargin;if(d<h&&(d+g-a.options.bottomMargin>k||j>h))i.eq(m).addClass(a.options.inViewClass)}});f=h+a.options.bottomMargin>=f?":last":":first";i.removeClass(a.options.selectedClass);i.filter("."+a.options.inViewClass+f).addClass(a.options.selectedClass)};a.init();a.findLocation()};b.visualNav.defaultOptions={link:"a",targetAttr:"href",inViewClass:"inView",selectedClass:"selected",selectedAppliedTo:"li",contentClass:".content",bottomMargin:100,animationTime:1200};b.fn.visualNav= function(e){return this.each(function(){new b.visualNav(this,e)})};b.fn.getvisualNav=function(){this.data("visualNav")}})(jQuery);
